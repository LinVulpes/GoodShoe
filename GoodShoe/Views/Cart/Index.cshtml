@model List<GoodShoe.Models.ViewModels.CartItem>

<h2>Your Cart</h2>

@if (!Model.Any())
{
    <p>Your cart is empty.</p>
}
else
{
    <div class="cart-container">
        <div class="cart-items">
            @foreach (var item in Model)
            {
                <div class="cart-item">
                    <img src="@item.ImageUrl"
                         alt="@item.Name"
                         class="item-image" />

                    <div class="item-details">
                        <h3>@item.Name</h3>
                        <p>Size: @item.Size</p>
                        <p>Qty: @item.Quantity</p>
                    </div>

                    <div class="item-price">
                        <p>@item.Price.ToString("C")</p>
                        <p>
                            Subtotal:
                            @(item.Price * item.Quantity).ToString("C")
                        </p>

                        <form asp-action="RemoveFromCart" method="post">
                            <input type="hidden" name="productId" value="@item.ProductId" />
                            <input type="hidden" name="size" value="@item.Size" />
                            <button type="submit" class="remove-btn">Remove Item</button>
                        </form>
                    </div>
                </div>
            }
        </div>

        <div class="summary">
            <h3>Order Summary</h3>
            <div class="summary-line">
                <span>Subtotal</span>
                <span>@(Model.Sum(i => i.Price * i.Quantity).ToString("C"))</span>
            </div>
            <div class="summary-line">
                <span>Estimated Delivery & Handling</span>
                <span>$20.00</span>
            </div>
            <div class="summary-line total">
                <span>Total</span>
                <span>
                    @(Model.Sum(i => i.Price * i.Quantity) + 20).ToString("C")
                </span>
            </div>

            <form asp-controller="Order" asp-action="Checkout" method="get">
                <button type="submit"
                        class="payment-button"
                @(Model.Count == 0 ? "disabled" : "")>
                    Proceed to Payment
                </button>
            </form>

            <form asp-controller="Home" asp-action="Products" method="get">
                <button type="submit" class="btn btn-secondary">
                    Continue Shopping
                </button>
            </form>
        </div>
    </div>
}
